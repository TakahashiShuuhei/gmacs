# gmacs 開発計画

## プロジェクト概要
Go言語で実装するEmacs風テキストエディタ。Emacsとの完全な互換性は求めないが、Emacsの主要な概念（ウィンドウ、バッファ、メジャーモード、マイナーモード、インタラクティブ関数、キーマップ等）を活用する。

## 開発フェーズ

### Phase 1: 基本データ構造とコマンドシステム
1. **基本データ構造**
   - [x] Buffer（バッファ）
   - [x] Window（ウィンドウ）
   - [x] カーソル管理

2. **コマンドシステムの基盤**
   - [ ] インタラクティブ関数の定義・登録システム
   - [ ] M-x コマンド実行機能
   - [ ] コマンド名前空間の管理

3. **基本的なキーマップシステム**
   - [ ] キーバインドの定義・登録
   - [ ] インタラクティブ関数とキーバインドの関連付け
   - [ ] 基本的なキー入力処理

4. **最小限の表示システム**
   - [ ] 基本的なターミナルUI
   - [ ] M-x プロンプトの表示
   - [ ] メッセージ表示

### Phase 2: コア機能（すべてインタラクティブ関数として実装）
1. **基本編集機能（インタラクティブ関数）**
   - [ ] テキスト挿入・削除
   - [ ] カーソル移動
   - [ ] 基本的なファイルI/O（find-file, save-buffer等）

2. **バッファ・ウィンドウ管理（インタラクティブ関数）**
   - [ ] バッファ切り替え
   - [ ] ウィンドウ分割・統合
   - [ ] 複数バッファの管理

### Phase 3: 設定システムとパッケージシステム
1. **設定システム**
   - [ ] Go言語による設定ファイル（init.go）
   - [ ] 動的な設定変更
   - [ ] 設定の永続化

2. **パッケージシステム**
   - [ ] Go言語によるパッケージ開発API
   - [ ] パッケージの動的ロード
   - [ ] パッケージ管理システム

3. **モードシステム**
   - [ ] メジャーモード・マイナーモードの基盤
   - [ ] モード固有のキーマップ
   - [ ] フック機能

### Phase 4: 高度な機能
1. **検索・置換システム**
   - [ ] 検索機能（isearch等）
   - [ ] 置換機能（query-replace等）

2. **構文ハイライト**
   - [ ] 基本的な言語サポート
   - [ ] 拡張可能な構文定義

3. **補完機能**
   - [ ] ファイル名補完
   - [ ] テキスト補完
   - [ ] コマンド補完

## 技術的決定事項

### アーキテクチャ方針
- **MVC パターン**の採用
  - Model: Buffer, Document
  - View: Display, Renderer  
  - Controller: Editor, EventHandler

- **イベント駆動アーキテクチャ**
  - キーボード入力、ファイル変更等のイベント処理

### パッケージ構成（予定）
```
github.com/TakahashiShuuhei/gmacs/
├── cmd/gmacs/          # メインエントリポイント
├── internal/
│   ├── buffer/         # バッファ管理
│   ├── window/         # ウィンドウ管理
│   ├── display/        # 表示システム
│   ├── keymap/         # キーマップシステム
│   ├── mode/           # モードシステム
│   ├── command/        # コマンドシステム
│   ├── config/         # 設定管理
│   └── util/           # ユーティリティ
└── pkg/                # 公開API（拡張用）
```

## 実装順序と進捗
- [x] 1. 基本的なCLIアプリケーションの枠組み
- [x] 2. 基本データ構造（Buffer, Window, カーソル）
- [ ] 3. インタラクティブ関数システム（関数の定義・登録・実行）
- [ ] 4. M-x コマンド実行機能
- [ ] 5. 基本的なキーマップとキーバインド
- [ ] 6. 最小限のターミナルUI（M-xプロンプト表示）
- [ ] 7. 基本編集機能をインタラクティブ関数として実装
- [ ] 8. 設定システム（Go言語による設定ファイル）
- [ ] 9. パッケージシステム（動的ロード・API提供）

## 参考資料
- `/emacs/` ディレクトリ内のEmacsソースコード
- Emacs Lisp Manual
- Go言語標準ライブラリ仕様